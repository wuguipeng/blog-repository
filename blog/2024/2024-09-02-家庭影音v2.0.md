---
slug: jiatingyingyinv2.0
title: 折腾｜家庭影音v2.0
authors: [wuguipeng]
tags: [mymedia,toss]
--- 

# 说在前面

在去年，我买了台AppleTV，并在年底写了一篇[家庭影音v1.0](https://www.notion.so/v1-0-26c9116cb128463c9ee904cb86876ee6?pvs=21)，当时使用的是AppleTV+阿里云盘+Infuse的组合，阿里云也还没有限速，我在老家可以跑满300Mbps，配合**aliyundrive-subscribe**自动更新阿里云资源，除了Infuse刮削的问题外，基本上已经满足我个人使用了。

但是在今年，阿里云陆续限制非会员用户，还推出了《三方应用权益包》不仅非会员受到影响，就连原有的会员用户，要想使用第三方不限速，需要加购《三方应用权益包》，一个月17块钱只有1024GB流量。要想正常使用阿里云搭建媒体影音，一年的会员费用就需要300多块钱，容量还不能随意扩容，至此，使用阿里云搭建媒体库已经不可行了。
<!-- truncate -->


在发现阿里云开始限制非会员用的的时候，我开始尝试使用115网盘中。去年我有尝试过在一台香港的服务器上搭建过alist，挂载115测试速度很低，达不到8mbps，当时有阿里云可用，就放弃了。今年我在我本地的一台window电脑上安装的alist，偶尔打开一个在115网盘的视频时，发现alist上的115网盘秒开（当时刚刚升级了带宽，从电信20mbps升级到了100mbps），我有点惊讶，然后存了一个更大的视频，测了一下发现确实很快。至此，我开始全面转移到115网盘。

# 扩容115网盘

在测试115原石会员不限速的时候，我马上在淘宝以30块钱买了一个5TB的扩容包，买的时候忘记了新用户直接开原石号要便宜很多。后来5TB不够用的时候，又花了65块钱买了一个33TB的原石号。为了让我的主力手机号能购买33TB原石要，还进行了一番操作，主力手机号已经注册了，并且买了一个5TB的扩容卡，要想使用这个手机号可以重新注册，需要把这个主力号给注销了才行，我有点舍不得这5TB容量，就想着是不是可以把主力号转移到另一个手机号，然后就能注册了？我带着这个疑问尝试着把主力号转移到另一个手机号，转移的过程中发现另一个手机号已经注册了，注销还需要14天的时间。我觉得这个方法应该可行，我就去找咸鱼卖号的人问，他说可以，他还可以提供马上注销服务，但是需要5块钱服务费。我想着，我也不是马上就需要，我可以先等14天再说。

14天后，另一个手机号注销成功，并把主力号转移过去，然后在咸鱼以65块钱买了33TB原石号，33TB应该够我用很久了，如果不够用，再继续买扩容包就行，扩容包的价格再6块钱1TB左右。

# 如何解决资源及时更新问题

有了不限速、大容量的网盘，下一步就是想办法解决资源更新的问题了。这里先说一下阿里云盘和115网盘资源分享的规则。

经过我的测试发现115网盘已经分享的文件夹不能动态更新，也就是说，分享的时候，文件夹有哪些内容就能转存哪些内容，无法像阿里云盘那样动态更新分享连接。

例如：一个文件夹A，里面有a.txt，b.txt，在阿里云盘里创建一个分享连接C，115网盘里创建一个分享连接D，现在我在文件夹A继续增加一个文件c.txt，阿里云盘的分享连接C可以看到文件c.txt，而115的分享连接D则不能看到文件c.txt，115网盘只能通过创建一个新的分享连接E，才能看到文件c

.txt。

因为这种机制，无法使用类似**aliyundrive-subscribe**这样的软件自动订阅更新。在115网盘中，可以使用以下方式进行资源转存：

1. **通过分享连接进行转存**，但是115并没有阿里云那样的推广机制（通过分享可以获得一定的容量，最高可达20TB），所以相对于阿里云，115分享的资源会少很多，但是这种方式进行转存，不会限制文件大小。
2. **通过云下载**，这个只有会员，或者单独购买（15块钱100次）云下载次数才能使用，我只在买33T原石号的时候送了一周体验卡，好用是好用，但是觉得要花钱还是算了。
3. **通过alist使用其他网盘进行秒传**，我试过阿里云盘，百度网盘和夸克网盘，只有配合阿里云盘才能较好的进行秒传，其他都需要先下载再上传，百度夸克本来就限速，传一个几GB的文件都要好久，只有在其他平台都找不到资源时，才会使用这种方式。通过这种方式会受非会员最大5GB文件上传限制，动漫单集很少超过5GB，这也是我常用的方式。
4. **通过qBittorrent下载，然后上传到115**。通过clouddrive2将115挂载到目录上，qBittorrent下载完成之后通过一段脚本，将文件移动到115网盘中，如果文件是115网盘中已有的，同样支持秒传，同样受5GB文件大小限制。这是我主要更新实时资源的方式，一般比较新的资源，bt都能下载，动漫资源单集大小很少超过5GB。

这里吐槽一下tg上某些人真以为115是自己开，这么帮着115，分享的资源都是以电驴（一种比较老的资源分享方式）连接分享，通过这种方式分享的资源，只有会员用户才能转存，非会员用户根本用不了，我实在是有点看不惯，所以我自己整理资源的过程中，也会以115分享连接的方式分享，不管是会员还是非会员，都能转存。

# 媒体服务器选择

常见的媒体服务器有emby，plex和jellyfin，其中jellyfin是开源的，emby免费用户也能正常使用，只有特殊功能才需要会员，plex没有会员有很多限制，在安卓ios中不能直接播放，很多人只使用plex进行刮削，播放使用第三方。

没一个我都有使用过，最后选择了jellyfin，plex的刮削确实牛逼，但是不开会员总感觉有点不爽。还有一点，plex的帐号不是在你的服务器，而是在plex的服务器，可以通过plex的服务器访问你的服务器，在远程进行播放的时候，访问的是plex的域名，然后在解析到你自己的ip地址，plex想要在手机端播放，我还没有找到免费的，短暂的使用了一段时间后，陆陆续续转移到了jellyfin。emby我没有真正的稳定使用过，只是偶尔测试一下，我觉得emby和jellyfin很像，而jellyfin开源免费，就没有去尝试使用emby了。

jellyfin使用了一段时间后也逐渐适应了，客户端每个平台都有免费的方案，再配合alist解析115直链，不需要消耗服务器流量，能全平台播放。jellyfin自家就提供全平台客户端，第三方ios有infuse、vidhub、fileball，安卓findroid，还有一些其他的，就不一一列举了。

jellyfin只要自己够折腾，大部份功能都难实现。

# 最终效果

关于自建媒体服务器每个部分都有很多内容可以将，我只挑了网盘，资源更新方式，媒体服务器的选择，下面说一下我的媒体服务器的进化史。

- v1.0
    
    **网盘**：阿里云盘
    
    **资源更新**：aliyundrive-subscribe
    
    **整理**：手动
    
    **AppleTV客户端**：Infuse
    
- v2.0
    
    **网盘**：115网盘
    
    **媒体服务器**：plex
    
    **刮削**：plex
    
    **挂载**：alist+rclone
    
    **直链**：plex-nginx，需要alist返回直链
    
    **AppleTV客户端**：Infuse
    
    **整理**：手动
    
    **服务器**：plex、rclone、plex-nginx在甲骨文Arm机器上，alist在本地机器上
    
    **资源更新**：qBittorrent下载，115分享连接
    
- v2.1
    
    **网盘**：115网盘
    
    **媒体服务器**：jellyfin
    
    **刮削**：jellyfin+tmdb
    
    **挂载**：clouddrive2
    
    **直链**：emby-nginx
    
    **AppleTV客户端**：Infuse（主），fileball+vidhub（备用）
    
    **安卓客户端**：findriod
    
    **IOS客户端**：fileball
    
    **整理**：手动
    
    **观看记录同步**：track
    
    **服务器**：jellyfin、clouddrive2、emby-nginx、qBittorrent在甲骨文Arm机器上，alist在本地机器上
    
    **资源更新**：qBittorrent下载，115分享连接，阿里云盘（秒传），夸克网盘（下载上传）
    
- v2.2
    
    **网盘**：115网盘
    
    **媒体服务器**：jellyfin
    
    **刮削**：tmm（tmm可以指定指定电视机/剧集进行刮削，jellyfin只有指定媒体库）
    
    **整理**：tmm（tmm规定好重命名格式，在刮削的时候可以自动整理）
    
    **挂载**：clouddrive2
    
    **直链**：emby-nginx
    
    **AppleTV客户端**：Infuse（主），fileball+vidhub（备用）
    
    **安卓客户端**：findriod
    
    **IOS客户端**：fileball
    
    **观看记录同步**：track
    
    **服务器**：jellyfin、tmm、clouddrive2、alist在本地机器，qBittorrent、emby-nginx在甲骨文Arm服务器上
    
    **资源更新**：qBittorrent下载，115分享连接，阿里云盘（秒传），夸克网盘（下载上传）
    
    受限于115网盘风控，不得不将媒体服务器迁移到本地。
    

在v2.2版本中，局域网内访问很快，不需要通过emby-nginx获取alist的直链，可直接通过本地服务器的clouddrive2下载，然后串流到客户端。如果需要远程访问，可以通过frp内网穿透，emby-nginx获取直链，也能达到可用的程度，方便分享给朋友一起使用。

从阿里云开始限速，很多用户迁移到了115网盘，在使用的这段时间，发现115的风控也在逐渐变严格，如果那一天115也不行了，估计要将网盘换成nas了。

效果

![tmm刮削整理](https://oss.wuguipeng.com/image/2024/09/3cb4cb2cd2d9bc5db0095a585287e1c733bc23f3.png)

tmm刮削整理

![主页](https://oss.wuguipeng.com/image/2024/09/a6d637e188e7f13d361021f868a0310612a31847.png)

主页

![动漫更新](https://oss.wuguipeng.com/image/2024/09/ff7b1977aebabb4891669df185b962a2825a33a3.png)

动漫更新

# 再说一下AppleTV使用一年的感受吧

AppleTV的响应速度，流程度，都比荣耀电视机自带的要强非常多，在过去的一年里，成为了我主要的看电视平台，在AppleTV上，我主要使用的软件就两个，一个QuanX，一个Infuse。QuanX当旁路由非常好使，只要有稳定的节点，基本上不需要动它，只有在更新规则的时候，才会打开软件更新一下。Infuse连接媒体服务器看电视，在使用体验上比vidhub和fileball还是要要一些，花了20块钱就 一直用着。

遥控器被我摔的到处都是磕碰。